import{_ as n,a as t,b as e,c,i as o,s,d as r,S as i,C as a,W as f,E as u,f as l,F as p,l as $,G as d,n as g,A as m,H as y,I as h,J as v,k as b,q as w,u as _,aq as O,e as j,t as N,Q as S,g as x,h as D,j as P,m as R,o as k,O as F,T as A,R as B,v as C,w as E,y as M,X as U,aa as I,x as L,a5 as q,p as T,D as V}from"./client.9ec79f48.js";function G(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var o,s=t(n);if(c){var r=t(this).constructor;o=Reflect.construct(s,arguments,r)}else o=s.apply(this,arguments);return e(this,o)}}function H(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,c)}return e}function J(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?H(Object(e),!0).forEach((function(t){I(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):H(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function Q(n){var t,e;return{c:function(){t=j("div"),e=N("Nothing to Sync."),this.h()},l:function(n){t=x(n,"DIV",{style:!0});var c=D(t);e=P(c,"Nothing to Sync."),c.forEach(b),this.h()},h:function(){q(t,"margin","1em 0em")},m:function(n,c){g(n,t,c),k(t,e)},p:T,i:T,o:T,d:function(n){n&&b(t)}}}function W(n){var t,e;return(t=new V({props:{a:{grow:!0},$$slots:{default:[z]},$$scope:{ctx:n}}})).$on("click",n[5]),{c:function(){u(t.$$.fragment)},l:function(n){p(t.$$.fragment,n)},m:function(n,c){d(t,n,c),e=!0},p:function(n,e){var c={};1024&e&&(c.$$scope={dirty:e,ctx:n}),t.$set(c)},i:function(n){e||(y(t.$$.fragment,n),e=!0)},o:function(n){h(t.$$.fragment,n),e=!1},d:function(n){v(t,n)}}}function X(n){var t,e;return(t=new V({props:{a:{grow:!0},$$slots:{default:[K]},$$scope:{ctx:n}}})).$on("click",n[6]),{c:function(){u(t.$$.fragment)},l:function(n){p(t.$$.fragment,n)},m:function(n,c){d(t,n,c),e=!0},p:function(n,e){var c={};1024&e&&(c.$$scope={dirty:e,ctx:n}),t.$set(c)},i:function(n){e||(y(t.$$.fragment,n),e=!0)},o:function(n){h(t.$$.fragment,n),e=!1},d:function(n){v(t,n)}}}function z(n){var t;return{c:function(){t=N("Sync All")},l:function(n){t=P(n,"Sync All")},m:function(n,e){g(n,t,e)},d:function(n){n&&b(t)}}}function K(n){var t;return{c:function(){t=N("Clear Space")},l:function(n){t=P(n,"Clear Space")},m:function(n,e){g(n,t,e)},d:function(n){n&&b(t)}}}function Y(n){var t,e,c,o,s,r,i,a,f,u,p,d,m,v,w,_,O,C,E,M,U,I,L,q,T,V,G=(n[0].matching_files||"None")+"",H=(n[0].differences_found||"None")+"",J=(n[0].files_missing||"None")+"",z=(n[1]?n[1].length:"N/A")+"",K=(n[0].errors_while_checking||"None")+"",Y=[X,W,Q],Z=[];function nn(n,t){return n[0].differences_found||n[0].errors_while_checking||!n[2]||n[0].files_missing||0==n[1].length?0!=n[1].length?1:2:0}return L=nn(n),q=Z[L]=Y[L](n),{c:function(){t=j("div"),e=N("Used Memory: "),c=N(n[3]),o=j("br"),s=N("\n    Available Memory: "),r=N(n[4]),i=j("br"),a=N("\n    Synced Files: "),f=N(G),u=j("br"),p=N("\n    Unsynced Files: "),d=N(H),m=N(" ("),v=N(J),w=N(") "),_=j("br"),O=N("\n    Local Files: "),C=N(z),E=j("br"),M=N(" \n    Notices: "),U=N(K),I=l(),q.c(),T=S(),this.h()},l:function(l){t=x(l,"DIV",{class:!0});var g=D(t);e=P(g,"Used Memory: "),c=P(g,n[3]),o=x(g,"BR",{}),s=P(g,"\n    Available Memory: "),r=P(g,n[4]),i=x(g,"BR",{}),a=P(g,"\n    Synced Files: "),f=P(g,G),u=x(g,"BR",{}),p=P(g,"\n    Unsynced Files: "),d=P(g,H),m=P(g," ("),v=P(g,J),w=P(g,") "),_=x(g,"BR",{}),O=P(g,"\n    Local Files: "),C=P(g,z),E=x(g,"BR",{}),M=P(g," \n    Notices: "),U=P(g,K),g.forEach(b),I=$(l),q.l(l),T=S(),this.h()},h:function(){R(t,"class","pb1")},m:function(n,l){g(n,t,l),k(t,e),k(t,c),k(t,o),k(t,s),k(t,r),k(t,i),k(t,a),k(t,f),k(t,u),k(t,p),k(t,d),k(t,m),k(t,v),k(t,w),k(t,_),k(t,O),k(t,C),k(t,E),k(t,M),k(t,U),g(n,I,l),Z[L].m(n,l),g(n,T,l),V=!0},p:function(n,t){(!V||8&t)&&F(c,n[3]),(!V||16&t)&&F(r,n[4]),(!V||1&t)&&G!==(G=(n[0].matching_files||"None")+"")&&F(f,G),(!V||1&t)&&H!==(H=(n[0].differences_found||"None")+"")&&F(d,H),(!V||1&t)&&J!==(J=(n[0].files_missing||"None")+"")&&F(v,J),(!V||2&t)&&z!==(z=(n[1]?n[1].length:"N/A")+"")&&F(C,z),(!V||1&t)&&K!==(K=(n[0].errors_while_checking||"None")+"")&&F(U,K);var e=L;(L=nn(n))===e?Z[L].p(n,t):(A(),h(Z[e],1,1,(function(){Z[e]=null})),B(),(q=Z[L])||(q=Z[L]=Y[L](n)).c(),y(q,1),q.m(T.parentNode,T))},i:function(n){V||(y(q),V=!0)},o:function(n){h(q),V=!1},d:function(n){n&&b(t),n&&b(I),Z[L].d(n),n&&b(T)}}}function Z(n){var t,e,c,o;return t=new a({}),c=new f({props:{a:{grow:!0},className:"p06",$$slots:{default:[Y]},$$scope:{ctx:n}}}),{c:function(){u(t.$$.fragment),e=l(),u(c.$$.fragment)},l:function(n){p(t.$$.fragment,n),e=$(n),p(c.$$.fragment,n)},m:function(n,s){d(t,n,s),g(n,e,s),d(c,n,s),o=!0},p:function(n,t){var e=m(t,1)[0],o={};1055&e&&(o.$$scope={dirty:e,ctx:n}),c.$set(o)},i:function(n){o||(y(t.$$.fragment,n),y(c.$$.fragment,n),o=!0)},o:function(n){h(t.$$.fragment,n),h(c.$$.fragment,n),o=!1},d:function(n){v(t,n),n&&b(e),v(c,n)}}}function nn(n,t,e){var c;w(n,L,(function(n){return e(8,c=n)}));var o,s,r,i=t.data,a=void 0===i?{}:i,f=[],u=!1;function l(){return new Promise((function(n,t){M.set({type:"wait",message:"Checking Drive"}),U.get("/sync?as=json",{}).then((function(t){e(0,a=t.data),M.set(null),n(),U.get("/usb/recordings?as=json").then((function(n){e(1,f=n.data),console.log("[sync/index.svelte] 🗄✅  listed local files:",f.length),e(2,u=!0)})).catch((function(n){console.log("[sync/index.svelte] 🗄❌  could not list local files:",n)}))})).catch((function(n){M.set(J({type:"error"},n.response.data)),t()}))}))}return _(C(E.mark((function n(){return E.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:l();case 1:case"end":return n.stop()}}),n)})))),n.$$set=function(n){"data"in n&&e(0,a=n.data)},n.$$.update=function(){256&n.$$.dirty&&e(7,o=c.drives.find((function(n){return"/home/pi/pdac/usb"==n._mounted}))||{}),128&n.$$.dirty&&e(3,s=O(1e3*o._used).auto+" ("+o._capacity+")"),128&n.$$.dirty&&e(4,r=O(1e3*o._available).auto)},[a,f,u,s,r,function(){M.set({type:"wait",message:"Syncing Files<br />Please wait..."}),U.post("/sync?as=json",{}).then((function(n){l().finally((function(){M.set({type:"success",message:n.data,actions:[["Sessions","/session"],["Close","/sync"]]})}))})).catch((function(n){M.set(J({type:"error"},n.response.data))}))},function(){M.set({type:"wait",message:"Deleting Local Files"}),U.post("/sync/clearup?as=json",{}).then((function(n){console.log(n),setTimeout((function(){l().finally((function(){M.set(null)}))}),1e3)})).catch((function(n){M.set(J({type:"error"},n.response.data))}))}]}var tn=function(t){n(a,i);var e=G(a);function a(n){var t;return c(this,a),t=e.call(this),o(r(t),n,nn,Z,s,{data:0}),t}return a}();export default tn;
