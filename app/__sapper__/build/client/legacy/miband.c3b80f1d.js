import{v as n,w as t,A as e,_ as r,a,b as o,c,i as s,s as i,d as u,S as f,B as d,Y as $,C as l,f as p,D as m,l as g,E as b,n as y,L as v,G as h,H as O,I as w,k as j,q as k,am as M,O as x,P as S,M as D,e as P,t as C,g as I,h as N,j as R,o as _,F as B,R as E,y as V,z as q,x as z,a3 as A}from"./client.e39ef8f4.js";import{I as F}from"./IndexDropdown.fd1301fd.js";function G(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=a(n);if(t){var c=a(this).constructor;e=Reflect.construct(r,arguments,c)}else e=r.apply(this,arguments);return o(this,e)}}function H(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function L(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?H(Object(e),!0).forEach((function(t){A(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):H(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function Y(n){var t;return{c:function(){t=C("Change MiBand")},l:function(n){t=R(n,"Change MiBand")},m:function(n,e){y(n,t,e)},d:function(n){n&&j(t)}}}function J(n){var t;return{c:function(){t=C("Reconnect MiBand")},l:function(n){t=R(n,"Reconnect MiBand")},m:function(n,e){y(n,t,e)},d:function(n){n&&j(t)}}}function K(n){var t,e,r,a,o,c,s,i,u,f,d,$,v,k,M,V,q,z,A,G,H=(n[1]?n[1].number:"NONE")+"",L=(n[1]?n[1].mac_address:"~")+"",K=n[2].backend.miband.initialised?"Initialised":"Not Initialised",Q=n[2].backend.miband.connected?"Connected":"Not Connected";function T(t){n[6].call(null,t)}var U={};return void 0!==n[0]&&(U.a=n[0]),k=new F({props:U}),x.push((function(){return S(k,"a",T)})),k.$on("change",X),(q=new D({props:{a:{grow:!0},$$slots:{default:[Y]},$$scope:{ctx:n}}})).$on("click",n[3]),(A=new D({props:{a:{grow:!0},$$slots:{default:[J]},$$scope:{ctx:n}}})).$on("click",n[4]),{c:function(){t=P("div"),e=C("Current MiBand: "),r=C(H),a=C(" ( "),o=C(L),c=C(" )"),s=p(),i=P("div"),u=C("Status: \n    "),f=C(K),d=p(),$=C(Q),v=p(),l(k.$$.fragment),V=p(),l(q.$$.fragment),z=p(),l(A.$$.fragment)},l:function(n){t=I(n,"DIV",{});var l=N(t);e=R(l,"Current MiBand: "),r=R(l,H),a=R(l," ( "),o=R(l,L),c=R(l," )"),l.forEach(j),s=g(n),i=I(n,"DIV",{});var p=N(i);u=R(p,"Status: \n    "),f=R(p,K),d=g(p),$=R(p,Q),p.forEach(j),v=g(n),m(k.$$.fragment,n),V=g(n),m(q.$$.fragment,n),z=g(n),m(A.$$.fragment,n)},m:function(n,l){y(n,t,l),_(t,e),_(t,r),_(t,a),_(t,o),_(t,c),y(n,s,l),y(n,i,l),_(i,u),_(i,f),_(i,d),_(i,$),y(n,v,l),b(k,n,l),y(n,V,l),b(q,n,l),y(n,z,l),b(A,n,l),G=!0},p:function(n,t){(!G||2&t)&&H!==(H=(n[1]?n[1].number:"NONE")+"")&&B(r,H),(!G||2&t)&&L!==(L=(n[1]?n[1].mac_address:"~")+"")&&B(o,L),(!G||4&t)&&K!==(K=n[2].backend.miband.initialised?"Initialised":"Not Initialised")&&B(f,K),(!G||4&t)&&Q!==(Q=n[2].backend.miband.connected?"Connected":"Not Connected")&&B($,Q);var e={};!M&&1&t&&(M=!0,e.a=n[0],E((function(){return M=!1}))),k.$set(e);var a={};128&t&&(a.$$scope={dirty:t,ctx:n}),q.$set(a);var c={};128&t&&(c.$$scope={dirty:t,ctx:n}),A.$set(c)},i:function(n){G||(h(k.$$.fragment,n),h(q.$$.fragment,n),h(A.$$.fragment,n),G=!0)},o:function(n){O(k.$$.fragment,n),O(q.$$.fragment,n),O(A.$$.fragment,n),G=!1},d:function(n){n&&j(t),n&&j(s),n&&j(i),n&&j(v),w(k,n),n&&j(V),w(q,n),n&&j(z),w(A,n)}}}function Q(n){var t,e,r,a;return t=new d({}),r=new $({props:{className:"mlr06 pb1",a:{grow:!0},$$slots:{default:[K]},$$scope:{ctx:n}}}),{c:function(){l(t.$$.fragment),e=p(),l(r.$$.fragment)},l:function(n){m(t.$$.fragment,n),e=g(n),m(r.$$.fragment,n)},m:function(n,o){b(t,n,o),y(n,e,o),b(r,n,o),a=!0},p:function(n,t){var e=v(t,1)[0],a={};135&e&&(a.$$scope={dirty:e,ctx:n}),r.$set(a)},i:function(n){a||(h(t.$$.fragment,n),h(r.$$.fragment,n),a=!0)},o:function(n){O(t.$$.fragment,n),O(r.$$.fragment,n),a=!1},d:function(n){w(t,n),n&&j(e),w(r,n)}}}function T(n,t){return U.apply(this,arguments)}function U(){return(U=n(t.mark((function n(r,a){return t.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e(r,a,this));case 1:case"end":return n.stop()}}),n,this)})))).apply(this,arguments)}function W(n){return n?n.replace(/(\r\n|\n|\r)/gm,"").trim():""}function X(){}function Z(n,t,e){var r;k(n,q,(function(n){return e(2,r=n)}));var a,o=t.data,c={options:M,key:"number",grow:!0};return n.$$set=function(n){"data"in n&&e(5,o=n.data)},n.$$.update=function(){4&n.$$.dirty&&e(1,a=M.find((function(n){return W(n.mac_address)===W(r.backend.mac_address)})))},[c,a,r,function(){var n=M[c.value];console.log(n),n&&V.post("/system/miband?as=json",{mac_address:n.mac_address}).then((function(t){console.log("[Miband] ⌚️✅  Miband updated...",n.mac_address,n.number),q.grab()})).catch((function(n){console.log("[Miband] ⌚️❌ could not update ",n.toString(),Object.keys(n),n.response),z.set(L({type:"error"},n.response.data))}))},function(){console.log("[Session] ⌚️  Miband reconnecting..."),z.set({type:"wait",message:"Reconnecting to "+a.mac_address}),V.post("/system/miband/reconnect?as=json",{}).then((function(n){console.log("[Session] ⌚️✅  Miband connected"),z.set(null)})).catch((function(n){console.log("[Session] ⌚️❌ Miband could not reconnect ",n.toString(),Object.keys(n),n.response),z.set(L({type:"error"},n.response.data))}))},o,function(n){e(0,c=n)}]}var nn=function(n){r(e,f);var t=G(e);function e(n){var r;return c(this,e),r=t.call(this),s(u(r),n,Z,Q,i,{data:5}),r}return e}();export default nn;export{T as preload};
