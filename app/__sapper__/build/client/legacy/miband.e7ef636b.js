import{v as n,w as t,A as e,_ as r,a,b as o,c,i as s,s as i,d as u,S as f,B as d,X as $,z as l,f as p,C as m,l as g,D as b,n as y,K as v,F as h,G as O,H as w,k as j,q as k,am as x,N as M,O as S,L as D,e as N,t as C,g as P,h as _,j as I,o as R,E as B,Q as E,Y as V,x as q,y as z,a3 as A}from"./client.896f6249.js";import{I as F}from"./IndexDropdown.7fa46867.js";function G(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=a(n);if(t){var c=a(this).constructor;e=Reflect.construct(r,arguments,c)}else e=r.apply(this,arguments);return o(this,e)}}function H(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function K(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?H(Object(e),!0).forEach((function(t){A(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):H(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function L(n){var t;return{c:function(){t=C("Change MiBand")},l:function(n){t=I(n,"Change MiBand")},m:function(n,e){y(n,t,e)},d:function(n){n&&j(t)}}}function Q(n){var t;return{c:function(){t=C("Reconnect MiBand")},l:function(n){t=I(n,"Reconnect MiBand")},m:function(n,e){y(n,t,e)},d:function(n){n&&j(t)}}}function X(n){var t,e,r,a,o,c,s,i,u,f,d,$,v,k,x,V,q,z,A,G,H=(n[1]?n[1].number:"NONE")+"",K=(n[1]?n[1].mac_address:"~")+"",X=n[2].backend.miband.initialised?"Initialised":"Not Initialised",Y=n[2].backend.miband.connected?"Connected":"Not Connected";function J(t){n[6].call(null,t)}var T={};return void 0!==n[0]&&(T.a=n[0]),k=new F({props:T}),M.push((function(){return S(k,"a",J)})),k.$on("change",W),(q=new D({props:{a:{grow:!0},$$slots:{default:[L]},$$scope:{ctx:n}}})).$on("click",n[3]),(A=new D({props:{a:{grow:!0},$$slots:{default:[Q]},$$scope:{ctx:n}}})).$on("click",n[4]),{c:function(){t=N("div"),e=C("Current MiBand: "),r=C(H),a=C(" ( "),o=C(K),c=C(" )"),s=p(),i=N("div"),u=C("Status: \n    "),f=C(X),d=p(),$=C(Y),v=p(),l(k.$$.fragment),V=p(),l(q.$$.fragment),z=p(),l(A.$$.fragment)},l:function(n){t=P(n,"DIV",{});var l=_(t);e=I(l,"Current MiBand: "),r=I(l,H),a=I(l," ( "),o=I(l,K),c=I(l," )"),l.forEach(j),s=g(n),i=P(n,"DIV",{});var p=_(i);u=I(p,"Status: \n    "),f=I(p,X),d=g(p),$=I(p,Y),p.forEach(j),v=g(n),m(k.$$.fragment,n),V=g(n),m(q.$$.fragment,n),z=g(n),m(A.$$.fragment,n)},m:function(n,l){y(n,t,l),R(t,e),R(t,r),R(t,a),R(t,o),R(t,c),y(n,s,l),y(n,i,l),R(i,u),R(i,f),R(i,d),R(i,$),y(n,v,l),b(k,n,l),y(n,V,l),b(q,n,l),y(n,z,l),b(A,n,l),G=!0},p:function(n,t){(!G||2&t)&&H!==(H=(n[1]?n[1].number:"NONE")+"")&&B(r,H),(!G||2&t)&&K!==(K=(n[1]?n[1].mac_address:"~")+"")&&B(o,K),(!G||4&t)&&X!==(X=n[2].backend.miband.initialised?"Initialised":"Not Initialised")&&B(f,X),(!G||4&t)&&Y!==(Y=n[2].backend.miband.connected?"Connected":"Not Connected")&&B($,Y);var e={};!x&&1&t&&(x=!0,e.a=n[0],E((function(){return x=!1}))),k.$set(e);var a={};128&t&&(a.$$scope={dirty:t,ctx:n}),q.$set(a);var c={};128&t&&(c.$$scope={dirty:t,ctx:n}),A.$set(c)},i:function(n){G||(h(k.$$.fragment,n),h(q.$$.fragment,n),h(A.$$.fragment,n),G=!0)},o:function(n){O(k.$$.fragment,n),O(q.$$.fragment,n),O(A.$$.fragment,n),G=!1},d:function(n){n&&j(t),n&&j(s),n&&j(i),n&&j(v),w(k,n),n&&j(V),w(q,n),n&&j(z),w(A,n)}}}function Y(n){var t,e,r,a;return t=new d({}),r=new $({props:{className:"mlr06 pb1",a:{grow:!0},$$slots:{default:[X]},$$scope:{ctx:n}}}),{c:function(){l(t.$$.fragment),e=p(),l(r.$$.fragment)},l:function(n){m(t.$$.fragment,n),e=g(n),m(r.$$.fragment,n)},m:function(n,o){b(t,n,o),y(n,e,o),b(r,n,o),a=!0},p:function(n,t){var e=v(t,1)[0],a={};135&e&&(a.$$scope={dirty:e,ctx:n}),r.$set(a)},i:function(n){a||(h(t.$$.fragment,n),h(r.$$.fragment,n),a=!0)},o:function(n){O(t.$$.fragment,n),O(r.$$.fragment,n),a=!1},d:function(n){w(t,n),n&&j(e),w(r,n)}}}function J(n,t){return T.apply(this,arguments)}function T(){return(T=n(t.mark((function n(r,a){return t.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e(r,a,this));case 1:case"end":return n.stop()}}),n,this)})))).apply(this,arguments)}function U(n){return n?n.replace(/(\r\n|\n|\r)/gm,"").trim():""}function W(){}function Z(n,t,e){var r;k(n,q,(function(n){return e(2,r=n)}));var a,o=t.data,c={options:x,key:"number",grow:!0};return n.$$set=function(n){"data"in n&&e(5,o=n.data)},n.$$.update=function(){4&n.$$.dirty&&e(1,a=x.find((function(n){return U(n.mac_address)===U(r.backend.mac_address)})))},[c,a,r,function(){var n=x[c.value];console.log(n),n&&V.post("/system/miband?as=json",{mac_address:n.mac_address}).then((function(t){console.log("[Miband] ⌚️✅  Miband updated...",n.mac_address,n.number),q.grab()})).catch((function(n){console.log("[Miband] ⌚️❌ could not update ",n.toString(),Object.keys(n),n.response),z.set(K({type:"error"},n.response.data))}))},function(){console.log("[Session] ⌚️  Miband reconnecting..."),z.set({type:"wait",message:"Reconnecting to "+a.mac_address}),V.post("/system/miband/reconnect?as=json",{}).then((function(n){console.log("[Session] ⌚️✅  Miband connected"),z.set(null)})).catch((function(n){console.log("[Session] ⌚️❌ Miband could not reconnect ",n.toString(),Object.keys(n),n.response),z.set(K({type:"error"},n.response.data))}))},o,function(n){e(0,c=n)}]}var nn=function(n){r(e,f);var t=G(e);function e(n){var r;return c(this,e),r=t.call(this),s(u(r),n,Z,Y,i,{data:5}),r}return e}();export default nn;export{J as preload};
