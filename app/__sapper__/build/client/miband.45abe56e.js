import{S as n,i as e,s as t,aa as a,z as s,D as o,E as c,F as r,G as $,H as i,Z as d,_ as l,$ as u,ab as m,a3 as f,A as p,B as g,M as b,a as y,g as N,j as h,f as k,l as x,ac as M,P as w,Q as _,u as C,e as S,t as B,c as j,b as v,d as I,k as E,x as O,R,N as D,p as V,q}from"./client.877fc7f9.js";function z(n){let e;const t=n[3].default,a=d(t,n,n[10],null);return{c(){a&&a.c()},l(n){a&&a.l(n)},m(n,t){a&&a.m(n,t),e=!0},p(n,e){a&&a.p&&1024&e&&l(a,t,n,n[10],e,null,null)},i(n){e||(r(a,n),e=!0)},o(n){$(a,n),e=!1},d(n){a&&a.d(n)}}}function A(n){let e,t;return e=new a({props:{a:n[0],style:n[1],className:n[2],$$slots:{default:[z]},$$scope:{ctx:n}}}),e.$on("click",n[4]),e.$on("focus",n[5]),e.$on("input",n[6]),e.$on("blur",n[7]),e.$on("change",n[8]),e.$on("keypress",n[9]),{c(){s(e.$$.fragment)},l(n){o(e.$$.fragment,n)},m(n,a){c(e,n,a),t=!0},p(n,[t]){const a={};1&t&&(a.a=n[0]),2&t&&(a.style=n[1]),4&t&&(a.className=n[2]),1024&t&&(a.$$scope={dirty:t,ctx:n}),e.$set(a)},i(n){t||(r(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){i(e,n)}}}function F(n,e,t){let{a:a}=e;a={...u[m],...a};let{style:s=""}=e,{className:o=""}=e,{$$slots:c={},$$scope:r}=e;return n.$$set=n=>{"a"in n&&t(0,a=n.a),"style"in n&&t(1,s=n.style),"className"in n&&t(2,o=n.className),"$$scope"in n&&t(10,r=n.$$scope)},[a,s,o,c,function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},r]}class G extends n{constructor(n){super(),e(this,n,F,A,t,{a:0,style:1,className:2})}}function H(n){let e;return{c(){e=B("Change MiBand")},l(n){e=I(n,"Change MiBand")},m(n,t){h(n,e,t)},d(n){n&&k(e)}}}function P(n){let e;return{c(){e=B("Reconnect MiBand")},l(n){e=I(n,"Reconnect MiBand")},m(n,t){h(n,e,t)},d(n){n&&k(e)}}}function Q(n){let e,t,a,d,l,u,m,f,p,g,b,x,M,D,V,q,z,A,F,Q,Z=(n[1]?n[1].number:"NONE")+"",J=(n[1]?n[1].mac_address:"~")+"",K=n[2].backend.miband.initialised?"Initialised":"Not Initialised",T=n[2].backend.miband.connected?"Connected":"Not Connected";function U(e){n[6].call(null,e)}let W={};return void 0!==n[0]&&(W.a=n[0]),D=new G({props:W}),w.push(()=>_(D,"a",U)),D.$on("change",L),z=new C({props:{a:{grow:!0},$$slots:{default:[H]},$$scope:{ctx:n}}}),z.$on("click",n[3]),F=new C({props:{a:{grow:!0},$$slots:{default:[P]},$$scope:{ctx:n}}}),F.$on("click",n[4]),{c(){e=S("div"),t=B("Current MiBand: "),a=B(Z),d=B(" ( "),l=B(J),u=B(" )"),m=y(),f=S("div"),p=B("Status: \n    "),g=B(K),b=y(),x=B(T),M=y(),s(D.$$.fragment),q=y(),s(z.$$.fragment),A=y(),s(F.$$.fragment)},l(n){e=j(n,"DIV",{});var s=v(e);t=I(s,"Current MiBand: "),a=I(s,Z),d=I(s," ( "),l=I(s,J),u=I(s," )"),s.forEach(k),m=N(n),f=j(n,"DIV",{});var c=v(f);p=I(c,"Status: \n    "),g=I(c,K),b=N(c),x=I(c,T),c.forEach(k),M=N(n),o(D.$$.fragment,n),q=N(n),o(z.$$.fragment,n),A=N(n),o(F.$$.fragment,n)},m(n,s){h(n,e,s),E(e,t),E(e,a),E(e,d),E(e,l),E(e,u),h(n,m,s),h(n,f,s),E(f,p),E(f,g),E(f,b),E(f,x),h(n,M,s),c(D,n,s),h(n,q,s),c(z,n,s),h(n,A,s),c(F,n,s),Q=!0},p(n,e){(!Q||2&e)&&Z!==(Z=(n[1]?n[1].number:"NONE")+"")&&O(a,Z),(!Q||2&e)&&J!==(J=(n[1]?n[1].mac_address:"~")+"")&&O(l,J),(!Q||4&e)&&K!==(K=n[2].backend.miband.initialised?"Initialised":"Not Initialised")&&O(g,K),(!Q||4&e)&&T!==(T=n[2].backend.miband.connected?"Connected":"Not Connected")&&O(x,T);const t={};!V&&1&e&&(V=!0,t.a=n[0],R(()=>V=!1)),D.$set(t);const s={};128&e&&(s.$$scope={dirty:e,ctx:n}),z.$set(s);const o={};128&e&&(o.$$scope={dirty:e,ctx:n}),F.$set(o)},i(n){Q||(r(D.$$.fragment,n),r(z.$$.fragment,n),r(F.$$.fragment,n),Q=!0)},o(n){$(D.$$.fragment,n),$(z.$$.fragment,n),$(F.$$.fragment,n),Q=!1},d(n){n&&k(e),n&&k(m),n&&k(f),n&&k(M),i(D,n),n&&k(q),i(z,n),n&&k(A),i(F,n)}}}function Z(n){let e,t,a,d;return e=new g({}),a=new b({props:{className:"mlr06 pb1",a:{grow:!0},$$slots:{default:[Q]},$$scope:{ctx:n}}}),{c(){s(e.$$.fragment),t=y(),s(a.$$.fragment)},l(n){o(e.$$.fragment,n),t=N(n),o(a.$$.fragment,n)},m(n,s){c(e,n,s),h(n,t,s),c(a,n,s),d=!0},p(n,[e]){const t={};135&e&&(t.$$scope={dirty:e,ctx:n}),a.$set(t)},i(n){d||(r(e.$$.fragment,n),r(a.$$.fragment,n),d=!0)},o(n){$(e.$$.fragment,n),$(a.$$.fragment,n),d=!1},d(n){i(e,n),n&&k(t),i(a,n)}}}async function J(n,e){return p(n,e,this)}function K(n){return n?n.replace(/(\r\n|\n|\r)/gm,"").trim():""}function L(){}function T(n,e,t){let a;x(n,V,n=>t(2,a=n));let s,{data:o}=e,c={options:M,key:"number",grow:!0};return n.$$set=n=>{"data"in n&&t(5,o=n.data)},n.$$.update=()=>{4&n.$$.dirty&&t(1,s=M.find(n=>K(n.mac_address)===K(a.backend.mac_address)))},[c,s,a,function(){let n=M[c.value];console.log(n),n&&D.post("/system/miband?as=json",{mac_address:n.mac_address}).then(e=>{console.log("[Miband] ⌚️✅  Miband updated...",n.mac_address,n.number),V.grab()}).catch(n=>{console.log("[Miband] ⌚️❌ could not update ",n.toString(),Object.keys(n),n.response),q.set({type:"error",...n.response.data})})},function(){console.log("[Session] ⌚️  Miband reconnecting..."),q.set({type:"wait",message:"Reconnecting to "+s.mac_address}),D.post("/system/miband/reconnect?as=json",{}).then(n=>{console.log("[Session] ⌚️✅  Miband connected"),q.set(null)}).catch(n=>{console.log("[Session] ⌚️❌ Miband could not reconnect ",n.toString(),Object.keys(n),n.response),q.set({type:"error",...n.response.data})})},o,function(n){c=n,t(0,c)}]}export default class extends n{constructor(n){super(),e(this,n,T,Z,t,{data:5})}}export{J as preload};
