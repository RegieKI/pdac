import{S as n,i as e,s as t,ad as a,E as s,G as o,H as c,I as r,J as $,K as i,a0 as d,a1 as l,a2 as u,ae as m,a6 as f,A as p,B as g,P as b,a as y,g as N,j as h,f as k,l as x,af as M,U as w,V as C,u as S,e as _,t as B,c as I,b as j,d as v,k as E,C as O,W as R,Q as V,p as D,q}from"./client.d0112671.js";function A(n){let e;const t=n[3].default,a=d(t,n,n[10],null);return{c(){a&&a.c()},l(n){a&&a.l(n)},m(n,t){a&&a.m(n,t),e=!0},p(n,e){a&&a.p&&1024&e&&l(a,t,n,n[10],e,null,null)},i(n){e||(r(a,n),e=!0)},o(n){$(a,n),e=!1},d(n){a&&a.d(n)}}}function G(n){let e,t;return e=new a({props:{a:n[0],style:n[1],className:n[2],$$slots:{default:[A]},$$scope:{ctx:n}}}),e.$on("click",n[4]),e.$on("focus",n[5]),e.$on("input",n[6]),e.$on("blur",n[7]),e.$on("change",n[8]),e.$on("keypress",n[9]),{c(){s(e.$$.fragment)},l(n){o(e.$$.fragment,n)},m(n,a){c(e,n,a),t=!0},p(n,[t]){const a={};1&t&&(a.a=n[0]),2&t&&(a.style=n[1]),4&t&&(a.className=n[2]),1024&t&&(a.$$scope={dirty:t,ctx:n}),e.$set(a)},i(n){t||(r(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){i(e,n)}}}function H(n,e,t){let{a:a}=e;a={...u[m],...a};let{style:s=""}=e,{className:o=""}=e,{$$slots:c={},$$scope:r}=e;return n.$$set=n=>{"a"in n&&t(0,a=n.a),"style"in n&&t(1,s=n.style),"className"in n&&t(2,o=n.className),"$$scope"in n&&t(10,r=n.$$scope)},[a,s,o,c,function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},r]}class J extends n{constructor(n){super(),e(this,n,H,G,t,{a:0,style:1,className:2})}}function K(n){let e;return{c(){e=B("Change MiBand")},l(n){e=v(n,"Change MiBand")},m(n,t){h(n,e,t)},d(n){n&&k(e)}}}function P(n){let e;return{c(){e=B("Reconnect MiBand")},l(n){e=v(n,"Reconnect MiBand")},m(n,t){h(n,e,t)},d(n){n&&k(e)}}}function Q(n){let e,t,a,d,l,u,m,f,p,g,b,x,M,V,D,q,A,G,H,Q,U=(n[1]?n[1].number:"NONE")+"",W=(n[1]?n[1].mac_address:"~")+"",z=n[2].backend.miband.initialised?"Initialised":"Not Initialised",L=n[2].backend.miband.connected?"Connected":"Not Connected";function T(e){n[6].call(null,e)}let X={};return void 0!==n[0]&&(X.a=n[0]),V=new J({props:X}),w.push(()=>C(V,"a",T)),V.$on("change",F),A=new S({props:{a:{grow:!0},$$slots:{default:[K]},$$scope:{ctx:n}}}),A.$on("click",n[3]),H=new S({props:{a:{grow:!0},$$slots:{default:[P]},$$scope:{ctx:n}}}),H.$on("click",n[4]),{c(){e=_("div"),t=B("Current MiBand: "),a=B(U),d=B(" ( "),l=B(W),u=B(" )"),m=y(),f=_("div"),p=B("Status: \n    "),g=B(z),b=y(),x=B(L),M=y(),s(V.$$.fragment),q=y(),s(A.$$.fragment),G=y(),s(H.$$.fragment)},l(n){e=I(n,"DIV",{});var s=j(e);t=v(s,"Current MiBand: "),a=v(s,U),d=v(s," ( "),l=v(s,W),u=v(s," )"),s.forEach(k),m=N(n),f=I(n,"DIV",{});var c=j(f);p=v(c,"Status: \n    "),g=v(c,z),b=N(c),x=v(c,L),c.forEach(k),M=N(n),o(V.$$.fragment,n),q=N(n),o(A.$$.fragment,n),G=N(n),o(H.$$.fragment,n)},m(n,s){h(n,e,s),E(e,t),E(e,a),E(e,d),E(e,l),E(e,u),h(n,m,s),h(n,f,s),E(f,p),E(f,g),E(f,b),E(f,x),h(n,M,s),c(V,n,s),h(n,q,s),c(A,n,s),h(n,G,s),c(H,n,s),Q=!0},p(n,e){(!Q||2&e)&&U!==(U=(n[1]?n[1].number:"NONE")+"")&&O(a,U),(!Q||2&e)&&W!==(W=(n[1]?n[1].mac_address:"~")+"")&&O(l,W),(!Q||4&e)&&z!==(z=n[2].backend.miband.initialised?"Initialised":"Not Initialised")&&O(g,z),(!Q||4&e)&&L!==(L=n[2].backend.miband.connected?"Connected":"Not Connected")&&O(x,L);const t={};!D&&1&e&&(D=!0,t.a=n[0],R(()=>D=!1)),V.$set(t);const s={};128&e&&(s.$$scope={dirty:e,ctx:n}),A.$set(s);const o={};128&e&&(o.$$scope={dirty:e,ctx:n}),H.$set(o)},i(n){Q||(r(V.$$.fragment,n),r(A.$$.fragment,n),r(H.$$.fragment,n),Q=!0)},o(n){$(V.$$.fragment,n),$(A.$$.fragment,n),$(H.$$.fragment,n),Q=!1},d(n){n&&k(e),n&&k(m),n&&k(f),n&&k(M),i(V,n),n&&k(q),i(A,n),n&&k(G),i(H,n)}}}function U(n){let e,t,a,d;return e=new g({}),a=new b({props:{className:"mlr06 pb1",a:{grow:!0},$$slots:{default:[Q]},$$scope:{ctx:n}}}),{c(){s(e.$$.fragment),t=y(),s(a.$$.fragment)},l(n){o(e.$$.fragment,n),t=N(n),o(a.$$.fragment,n)},m(n,s){c(e,n,s),h(n,t,s),c(a,n,s),d=!0},p(n,[e]){const t={};135&e&&(t.$$scope={dirty:e,ctx:n}),a.$set(t)},i(n){d||(r(e.$$.fragment,n),r(a.$$.fragment,n),d=!0)},o(n){$(e.$$.fragment,n),$(a.$$.fragment,n),d=!1},d(n){i(e,n),n&&k(t),i(a,n)}}}async function W(n,e){return p(n,e,this)}function z(n){return n?n.replace(/(\r\n|\n|\r)/gm,"").trim():""}function F(){}function L(n,e,t){let a;x(n,D,n=>t(2,a=n));let s,{data:o}=e,c={options:M,key:"number",grow:!0};return n.$$set=n=>{"data"in n&&t(5,o=n.data)},n.$$.update=()=>{4&n.$$.dirty&&t(1,s=M.find(n=>z(n.mac_address)===z(a.backend.mac_address)))},[c,s,a,function(){let n=M[c.value];console.log(n),n&&V.post("/system/miband?as=json",{mac_address:n.mac_address}).then(e=>{console.log("[Miband] ⌚️✅  Miband updated...",n.mac_address,n.number),D.grab()}).catch(n=>{console.log("[Miband] ⌚️❌ could not update ",n.toString(),Object.keys(n),n.response),q.set({type:"error",...n.response.data})})},function(){console.log("[Session] ⌚️  Miband reconnecting..."),q.set({type:"wait",message:"Reconnecting to "+s.mac_address}),V.post("/system/miband/reconnect?as=json",{}).then(n=>{console.log("[Session] ⌚️✅  Miband connected"),q.set(null)}).catch(n=>{console.log("[Session] ⌚️❌ Miband could not reconnect ",n.toString(),Object.keys(n),n.response),q.set({type:"error",...n.response.data})})},o,function(n){c=n,t(0,c)}]}export default class extends n{constructor(n){super(),e(this,n,L,U,t,{data:5})}}export{W as preload};
