import{S as n,i as e,s as t,ad as a,v as s,w as o,x as c,y as r,z as $,C as i,a0 as d,a1 as l,a2 as u,ae as m,a6 as f,A as p,B as g,O as b,a as y,g as N,j as h,f as k,l as x,af as w,R as M,U as C,u as S,e as _,t as v,c as B,b as j,d as I,k as O,H as E,V as R,P as V,p as D,q}from"./client.eb90a55a.js";function z(n){let e;const t=n[3].default,a=d(t,n,n[10],null);return{c(){a&&a.c()},l(n){a&&a.l(n)},m(n,t){a&&a.m(n,t),e=!0},p(n,e){a&&a.p&&1024&e&&l(a,t,n,n[10],e,null,null)},i(n){e||(r(a,n),e=!0)},o(n){$(a,n),e=!1},d(n){a&&a.d(n)}}}function A(n){let e,t;return e=new a({props:{a:n[0],style:n[1],className:n[2],$$slots:{default:[z]},$$scope:{ctx:n}}}),e.$on("click",n[4]),e.$on("focus",n[5]),e.$on("input",n[6]),e.$on("blur",n[7]),e.$on("change",n[8]),e.$on("keypress",n[9]),{c(){s(e.$$.fragment)},l(n){o(e.$$.fragment,n)},m(n,a){c(e,n,a),t=!0},p(n,[t]){const a={};1&t&&(a.a=n[0]),2&t&&(a.style=n[1]),4&t&&(a.className=n[2]),1024&t&&(a.$$scope={dirty:t,ctx:n}),e.$set(a)},i(n){t||(r(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){i(e,n)}}}function H(n,e,t){let{a:a}=e;a={...u[m],...a};let{style:s=""}=e,{className:o=""}=e,{$$slots:c={},$$scope:r}=e;return n.$$set=n=>{"a"in n&&t(0,a=n.a),"style"in n&&t(1,s=n.style),"className"in n&&t(2,o=n.className),"$$scope"in n&&t(10,r=n.$$scope)},[a,s,o,c,function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},function(e){f(n,e)},r]}class P extends n{constructor(n){super(),e(this,n,H,A,t,{a:0,style:1,className:2})}}function U(n){let e;return{c(){e=v("Change MiBand")},l(n){e=I(n,"Change MiBand")},m(n,t){h(n,e,t)},d(n){n&&k(e)}}}function F(n){let e;return{c(){e=v("Reconnect MiBand")},l(n){e=I(n,"Reconnect MiBand")},m(n,t){h(n,e,t)},d(n){n&&k(e)}}}function G(n){let e,t,a,d,l,u,m,f,p,g,b,x,w,V,D,q,z,A,H,G,J=(n[1]?n[1].number:"NONE")+"",K=(n[1]?n[1].mac_address:"~")+"",L=n[2].backend.miband.initialised?"Initialised":"Not Initialised",T=n[2].backend.miband.connected?"Connected":"Not Connected";function W(e){n[6].call(null,e)}let X={};return void 0!==n[0]&&(X.a=n[0]),V=new P({props:X}),M.push(()=>C(V,"a",W)),V.$on("change",Q),z=new S({props:{a:{grow:!0},$$slots:{default:[U]},$$scope:{ctx:n}}}),z.$on("click",n[3]),H=new S({props:{a:{grow:!0},$$slots:{default:[F]},$$scope:{ctx:n}}}),H.$on("click",n[4]),{c(){e=_("div"),t=v("Current MiBand: "),a=v(J),d=v(" ( "),l=v(K),u=v(" )"),m=y(),f=_("div"),p=v("Status: \n    "),g=v(L),b=y(),x=v(T),w=y(),s(V.$$.fragment),q=y(),s(z.$$.fragment),A=y(),s(H.$$.fragment)},l(n){e=B(n,"DIV",{});var s=j(e);t=I(s,"Current MiBand: "),a=I(s,J),d=I(s," ( "),l=I(s,K),u=I(s," )"),s.forEach(k),m=N(n),f=B(n,"DIV",{});var c=j(f);p=I(c,"Status: \n    "),g=I(c,L),b=N(c),x=I(c,T),c.forEach(k),w=N(n),o(V.$$.fragment,n),q=N(n),o(z.$$.fragment,n),A=N(n),o(H.$$.fragment,n)},m(n,s){h(n,e,s),O(e,t),O(e,a),O(e,d),O(e,l),O(e,u),h(n,m,s),h(n,f,s),O(f,p),O(f,g),O(f,b),O(f,x),h(n,w,s),c(V,n,s),h(n,q,s),c(z,n,s),h(n,A,s),c(H,n,s),G=!0},p(n,e){(!G||2&e)&&J!==(J=(n[1]?n[1].number:"NONE")+"")&&E(a,J),(!G||2&e)&&K!==(K=(n[1]?n[1].mac_address:"~")+"")&&E(l,K),(!G||4&e)&&L!==(L=n[2].backend.miband.initialised?"Initialised":"Not Initialised")&&E(g,L),(!G||4&e)&&T!==(T=n[2].backend.miband.connected?"Connected":"Not Connected")&&E(x,T);const t={};!D&&1&e&&(D=!0,t.a=n[0],R(()=>D=!1)),V.$set(t);const s={};128&e&&(s.$$scope={dirty:e,ctx:n}),z.$set(s);const o={};128&e&&(o.$$scope={dirty:e,ctx:n}),H.$set(o)},i(n){G||(r(V.$$.fragment,n),r(z.$$.fragment,n),r(H.$$.fragment,n),G=!0)},o(n){$(V.$$.fragment,n),$(z.$$.fragment,n),$(H.$$.fragment,n),G=!1},d(n){n&&k(e),n&&k(m),n&&k(f),n&&k(w),i(V,n),n&&k(q),i(z,n),n&&k(A),i(H,n)}}}function J(n){let e,t,a,d;return e=new g({}),a=new b({props:{className:"mlr06 pb1",a:{grow:!0},$$slots:{default:[G]},$$scope:{ctx:n}}}),{c(){s(e.$$.fragment),t=y(),s(a.$$.fragment)},l(n){o(e.$$.fragment,n),t=N(n),o(a.$$.fragment,n)},m(n,s){c(e,n,s),h(n,t,s),c(a,n,s),d=!0},p(n,[e]){const t={};135&e&&(t.$$scope={dirty:e,ctx:n}),a.$set(t)},i(n){d||(r(e.$$.fragment,n),r(a.$$.fragment,n),d=!0)},o(n){$(e.$$.fragment,n),$(a.$$.fragment,n),d=!1},d(n){i(e,n),n&&k(t),i(a,n)}}}async function K(n,e){return p(n,e,this)}function L(n){return n?n.replace(/(\r\n|\n|\r)/gm,"").trim():""}function Q(){}function T(n,e,t){let a;x(n,D,n=>t(2,a=n));let s,{data:o}=e,c={options:w,key:"number",grow:!0};return n.$$set=n=>{"data"in n&&t(5,o=n.data)},n.$$.update=()=>{4&n.$$.dirty&&t(1,s=w.find(n=>L(n.mac_address)===L(a.backend.mac_address)))},[c,s,a,function(){let n=w[c.value];console.log(n),n&&V.post("/system/miband?as=json",{mac_address:n.mac_address}).then(e=>{console.log("[Miband] ⌚️✅  Miband updated...",n.mac_address,n.number),D.grab()}).catch(n=>{console.log("[Miband] ⌚️❌ could not update ",n.toString(),Object.keys(n),n.response),q.set({type:"error",...n.response.data})})},function(){console.log("[Session] ⌚️  Miband reconnecting..."),q.set({type:"wait",message:"Reconnecting to "+s.mac_address}),V.post("/system/miband/reconnect?as=json",{}).then(n=>{console.log("[Session] ⌚️✅  Miband connected"),q.set(null)}).catch(n=>{console.log("[Session] ⌚️❌ Miband could not reconnect ",n.toString(),Object.keys(n),n.response),q.set({type:"error",...n.response.data})})},o,function(n){c=n,t(0,c)}]}export default class extends n{constructor(n){super(),e(this,n,T,J,t,{data:5})}}export{K as preload};
